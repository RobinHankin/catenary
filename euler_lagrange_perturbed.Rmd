---
-title: "Perturbing the Euler-Lagrange equations for calculus of variations: a first-order analysis"
author: "Robin Hankin"
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newcommand{\di}[2]{\frac{\partial{#1}}{\partial{#2}}}
\newcommand{\cx}{\cosh{\left(\frac{x-x_0}{a}\right)}}
\newcommand{\sx}{\sinh{\left(\frac{x-x_0}{a}\right)}}
\newcommand{\tx}{\tanh{\left(\frac{x-x_0}{a}\right)}}
\newcommand{\el}[1]{\frac{d}{dx}\di{#1}{y'} - \di{#1}{y}}

Consider a functional $F=F(x,y,y';\lambda)$ and a perturbation:

\begin{eqnarray}
y  &\longrightarrow&  y(x) + \epsilon z(x)\\
y' &\longrightarrow&  y'(x) + \epsilon z'(x)\\
F  &\longrightarrow&  F + \epsilon G(x,y,y')
\end{eqnarray}


\begin{eqnarray}
\frac{d}{dx}\di{F}{y'}=\di{F}{y}\nonumber\longrightarrow\\
\frac{d}{dx}\left[\di{}{y'}\left(F(x,y+\epsilon z,y'+\epsilon z')+\epsilon G(x,y+\epsilon z,y'+\epsilon z')\right)\right] =\\
\di{}{y}\left[F(x,y+\epsilon z,y'+\epsilon z')
+\epsilon G(x,y+\epsilon z,y'+\epsilon z')\right]
\end{eqnarray}

Above we write $y$ for $y(x)$ etc.  We have to remember that
$y,y',z,z'$ are functions of $x$.  Now neglect terms of order
$\epsilon^2$ and above, and continue to neglect them:

\begin{equation}
\left(\el{G}\right) + \left(z\di{}{y} + z'\di{}{y'} + z''\di{}{y''}\right)
\left(\el{F}\right)=0
\end{equation}


# Examples.

First, straight lines as in geometrical optics

\begin{equation}
F=\sqrt{1+y'^2},\qquad G = \phi(x,y)\sqrt{1+y'^2}
\end{equation}

Here we need

\begin{eqnarray}
\el{F} &=& \frac{d}{dt}\di{F}{y'}\\
       &=& \frac{d}{dt}\frac{y'}{\sqrt{1+y'^2}}\\
       &=& \frac{y''}{(1+y'^2)^{3/2}}\\
\end{eqnarray}

and 
\begin{eqnarray}
\el{G} &=& \frac{d}{dt}\di{G}{y'} - \phi_y\sqrt{1+y'^2}\\
       &=& \frac{d}{dt}\frac{y'\phi}{\sqrt{1+y'^2}} - \phi_y\sqrt{1+y'^2}\\
       &=& \frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'(\phi_x + y'\phi_y)}{\sqrt{1+y'^2}} - \phi_y\sqrt{1+y'^2}\\
       &=& \frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{1}{\sqrt{1+y'^2}}\left(y'(\phi_x + y'\phi_y) - \phi_y-\phi_yy^2\right)\\
       &=& \frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'\phi_x  -\phi_y}{\sqrt{1+y'^2}}
\end{eqnarray}


\begin{eqnarray}
\left(\el{G}\right) + \left(z\di{}{y} + z'\di{}{y'} + z''\di{}{y''}\right)
\left(\el{F}\right) &=& 0\\
\frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'\phi_x - \phi_y}{\sqrt{1+y'^2}} +
\left(z\di{}{y} + z'\di{}{y'} + z''\di{}{y''}\right)
\left(\frac{y''}{(1+y'^2)^{3/2}}\right)\\
\frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'\phi_x - \phi_y}{\sqrt{1+y'^2}} +
\left(z'\di{}{y'} + z''\di{}{y''}\right)
\left(\frac{y''}{(1+y'^2)^{3/2}}\right)\\
\frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'\phi_x - \phi_y}{\sqrt{1+y'^2}} +
\frac{-3y'y''z'}{(1+y'^2)^{5/2}} + \frac{z''}{(1+y'^2)^{3/2}} &=&0
\end{eqnarray}


At this point we observe that $y=a+sx$ [ "$s$" for slope] and so $y'=s$ and $y''=0$:

\begin{eqnarray}
\frac{y'\phi_x - \phi_y}{\sqrt{1+y'^2}} + \frac{z''}{(1+y'^2)^{3/2}} = 0\\
\frac{s\phi_x - \phi_y}{\sqrt{1+s^2}} + \frac{z''}{(1+s^2)^{3/2}} = 0
\end{eqnarray}

simplifying,

\begin{equation}
z'' = (1+s^2)(\phi_y -s\phi_x)
\end{equation}

