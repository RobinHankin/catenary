%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing
%%\documentclass[lineno,pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

\documentclass[pdflatex,sn-mathphys-num]{sn-jnl}% Math and Physical Sciences Numbered Reference Style

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%


\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}
\newcommand{\di}[2]{\frac{\partial{#1}}{\partial{#2}}}
\newcommand{\dii}[3]{\frac{\partial^2{#1}}{\partial{#2}\partial{#3}}}
\newcommand{\diii}[4]{\frac{\partial^3{#1}}{\partial{#2}\partial{#3}\partial{#4}}}
\newcommand{\el}[1]{\frac{d}{dx}\di{#1}{y'} - \di{#1}{y}}
\title[Article Title]{Article Title}

%%=============================================================%%
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% \author*[1,2]{\fnm{Joergen W.} \spfx{van der} \sur{Ploeg} 
%%  \sfx{IV}}\email{iauthor@gmail.com}
%%=============================================================%%

\author{\fnm{Robin} \sur{Hankin}}\email{hankin.robin@gmail.com}

\affil{\orgdiv{Computer and Mathematical Sciences}, \orgname{University of Stirling}, \city{Stirling}, \postcode{FK9 4LA}, \country{Scotland}}




\abstract{ This short document presents a method for dealing with
  slight perturbations to functionals.  We apply the Euler-Lagrange
  equations to a slightly perturbed functional and retain only terms to first order.

  Three applications from different areas of mathematical physics are
  presented.

  }

\keywords{keyword1, Keyword2, Keyword3, Keyword4}

%%\pacs[JEL Classification]{D8, H51}

%%\pacs[MSC Classification]{35A01, 65L10, 65L12, 65L20, 65L70}

\maketitle

\section{Introduction}\label{sec1}


The Euler-Lagrange equations were developed by Leonhard Euler and
Joseph-Louis Lagrange in the 1750s.  Following \citep{jeffreys1972},
suppose we have an integral of the form

\begin{equation}
F[y] = \int_{x_1}^{x_2} F(x,y(x),y'(x))\,dx
\end{equation}

\noindent where $F$ is a given functional and $y$ a function of $x$,
to be determined.  We wish to minimize the value of $F[y]$, over a
space of suitably well-behaved functions
$y\colon\left[x_1,x_2\right]\longrightarrow\mathbb{R}$.  Now suppose
we have identified such a $y$ that locally minimizes $F[y]$, and we
now consider a perturbed functional $\mathcal{F}=F+\epsilon G$.  We
take $\epsilon$ to be sufficiently small for us to neglect second and
higher powers.  Can we similarly perturb $y$ (to $y+\epsilon z$, say),
so as to minimize $F+\epsilon G$?

Under these circumstances, the perturbation term $z=z(x)$ is
interesting in its own right, and the fact the perturbation is linear
leads to new insight.

Formally, we suppose:

\begin{equation}
  \frac{d}{dx}\di{F}{y_0'}-\di{F}{y_0} = 0 
\end{equation}

and wish to identify a function $z(x)$ so that $y+\epsilon z(x)$ that
satisfies
\begin{equation}
  \frac{d}{dx}\di{(F+\epsilon G)}{y'}-\di{(F+\epsilon G)}{y} = 0.
\end{equation}
%
where $F$ and $G$ are evaluated at $y+\epsilon z$.  We have, working
to first order:

\begin{eqnarray}
\frac{d}{dx}\left[\left.\di{(F+\epsilon G)}{y'}\right|_{x,y+\epsilon z,y'+\epsilon z'}\right]
&=& \left.\di{(F+\epsilon G)}{y}\right|_{x,y+\epsilon z,y'+\epsilon z'}\nonumber\\
\frac{d}{dx}\left[\di{}{y'}\left(F + \epsilon z\di{F}{y} + \epsilon z'\di{F}{y'}+\epsilon G\right)\right]
&=& \di{}{y}\left(F + \epsilon z\di{F}{y} + \epsilon z'\di{F}{y'}+\epsilon G\right)\nonumber\\
\frac{d}{dx}\left[\di{F}{y'} + \epsilon\left(z\dii{F}{y}{y'} + z\dii{F}{y'}{y'} + \di{G}{y'}\right)\right]
&=& \di{F}{y} + \epsilon\left(z\dii{F}{y}{y} + z'\dii{F}{y}{y'} + \di{G}{y}\right)\nonumber\\
\frac{d}{dx}\left[z\dii{F}{y}{y'} + z'\dii{F}{y'}{y'} + \di{G}{y'}\right]
&=& z\dii{F}{y}{y} + z'\dii{F}{y}{y'} + \di{G}{y}
\end{eqnarray}
%
We now identify $\frac{d}{dx}$ with $\di{}{x} + y'\di{}{y} +
y''\di{}{y'} + z'\di{}{z} + z''\di{}{z'}$.  In the interests of
typographical convenience we revert to inline notation, viz
$\di{F}{y}\equiv\partial_yF\equiv F_y$.

\begin{eqnarray}
\frac{d}{dx}\left[zF_{yy'} + z'F_{y'y'} + G_{y'}\right]
&=& zF_{yy} + z'F_{yy'} + G_{y}\nonumber\\
\left(\partial_{x} + y'\partial_{y} + y''\partial_{y'} + z'\partial_{z} + z''\partial_{z'}\right)
\left[zF_{yy'} + z'F_{y'y'} + G_{y'}\right]
&=& zF_{yy} + z'F_{yy'} + G_{y}\nonumber\\
(zF_{xyy'} + z'F_{xy'y'} + G_{xy'})
+ (zy'F_{yyy'} + z'y'F_{yy'y'} + y'G_{yy'})\nonumber\\
+ ( zy''F_{yy'y'} + z'y''F_{y'y'y'} + y''G_{y'y'})
+ (z'F_{yy'} + z''F_{y'y'})
&=& zF_{yy} + z'F_{yy'} + G_{y}\nonumber\\
\end{eqnarray}

Collecting terms:

\begin{eqnarray}
&{}& z''F_{y'y'}\\
&+& z'(F_{xy'y'} + y'F_{yy'y'} + y''F_{y'y'y'})\\
&+& z (F_{xyy'} + y'F_{yyy'} + y''F_{yy'}-F_{yy})\\
&+& (G_{xy'} + y'G_{yy'} + y''G_{y'y'}- G_{y})\\
= 0
\end{eqnarray}
%
(above we cancel the $z'F_{yy'}$ term). This is a second order ODE in
$z$, which gives the first-order perturbation $z$ so that $y+\epsilon
z$ maximizes $F+\epsilon G$.  Alternatively, we may factorize the
expression, giving

\begin{equation}\label{factorized_eqn}
\left(\el{G}\right) + \left(z\di{}{y} + z'\di{}{y'} + z''\di{}{y''}\right)
\left(\el{F}\right)=0
\end{equation}

This equation is now applied to three simple classical problems in
which a functional is given a small perturbation of some sort.  The
examples are drawn from optics, statics, and the general theory of
relativity.

\section{Examples}

\subsection{Geometrical optics in a medium of slightly varying refractive index}

We consider two-dimensional ray paths in a medium of refractive index
$1+\phi(x,y)$.  The paths are given by solving the Euler-Lagrange
equations with functional $F=(1+\phi)\sqrt{1+y'^2}$:

\begin{eqnarray}
  \frac{d}{dx}\di{F}{y'}-\di{F}{y} &=& 0\nonumber\\
  \frac{(\phi_x+y'\phi_y)y'}{\sqrt{1+y'^2}}+\frac{(1+\phi)y''}{(1+y'^2)^{3/2}} -
  \phi_y\sqrt{1+y'^2} &=& 0
  \end{eqnarray}

Simplifying,

\begin{eqnarray}
 (1+\phi) y'' = (1+y'^2)(\phi_y - y'\phi_x)
\end{eqnarray}
%
Except for trivial cases such as $\phi_y=y'\phi_x$, this equation has
no simple (and certainly no intuitively insightful) analytic solution.
We now move to the linearised case, in which $F=\sqrt{1+y'^2}$ and
$G=\phi(x,y)\sqrt{1+y'^2}$.  Then

\begin{eqnarray}
  \el{F} &=& \frac{y''}{(1+y'^2)^{3/2}}\nonumber\\
  \el{G} &=& \frac{y''\phi}{(1+y'^2)^{3/2}} + \frac{y'\phi_x - \phi_y}{\sqrt{1+y'^2}}
\end{eqnarray}

Thus

\begin{eqnarray}
&{}& \left(z\di{}{y} + z'\di{}{y'} + z''\di{}{y''}\right)\left(\el{F}\right)\nonumber\\
&=&  z'\frac{1}{(1+y'^2)^{3/2}} -z''\frac{3y'}{(1+y'^2)^{5/2}}
\end{eqnarray}

whence equation~\ref{factorized_eqn} becomes

\begin{equation}
    \frac{z''}{(1+y'^2)^{3/2}}
  - \frac{3y'y''}{(1+y'^2)^{3/2}}
  + \frac{\phi_xy'}{\sqrt{1+y'^2}}
  + \frac{\phi_yy'^2}{\sqrt{1+y'^2}}
  + \frac{y''}{(1+y'^2)^{3/2}}-\phi_y\sqrt{1+y'^2}
\end{equation}

We recall that $y'' = 0$ in the unperturbed case, implying that $y'$
is constant.  Writing $y'= s$ we obtain

\begin{equation}\nonumber
  \frac{z''}{(1+s^2)^{3/2}} +
  \frac{\phi_xs}{\sqrt{1+s^2}} + \frac{\phi_ys^2}{\sqrt{1+s^2}} -\phi_y\sqrt{1+s^2}
\end{equation}

\begin{equation}
  z'' = (1+s^2)(\phi_y-\phi_xs)
\end{equation}

We may use this as a model for phenomena such as atmospheric refraction.


\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{euler_lagrange_perturbed_files/figure-latex/plotdelta-1.pdf}
\caption{Light rays following geometrical optics}\label{plotdelta}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{euler_lagrange_perturbed_files/figure-latex/plotdeltacloseup-1.pdf}
\caption{Light rays following geometrical optics}\label{plotdeltacloseup}
\end{figure}


\subsection{Catenary}

First the classical analysis with functional
$F=\sqrt{1+y'^2}(y+\Lambda)$.

\begin{eqnarray}
  \frac{d}{dx}\di{F}{y'} - \di{F}{y}
  &=& 
  \frac{d}{dx}\left[\frac{(y+\Lambda)y'}{\sqrt{1+y'^2}}\right] -  \frac{1}{\sqrt{1+y'^2}}\nonumber\\
&=&   \frac{y'^2}{\sqrt{1+y'^2}} + \frac{(y+\Lambda)y''}{(1+y'^2)^{3/2}} - \sqrt{1+y'^2}\nonumber\\
  &=&   \frac{(y+\Lambda)y''}{(1+y'^2)^{3/2}} - \frac{1}{\sqrt{1+y'^2}}
  \label{catenary_EL_f}
\end{eqnarray}

Rearranging equation~\ref{catenary_EL_f} gives

\begin{eqnarray}
  (y+\Lambda)y'' &=& 1+y'^2\label{catenary_ODE}
\end{eqnarray}

Equation~\ref{catenary_ODE} requires three constants for solution
(viz, two constants of integration arising from the fact that it is a
second order ODE, and Lagrange's multiplier $\Lambda$).  In practice,
these constants are determined by constraining three physical features
of the chain, typically the height of the curve at two points,
$y(x_1)$, $y(x_2)$ and the length of the chain between them,
$\int_{x_1}^{x_2}\sqrt{1+y'^2}\,dx$.  For ease of exposition we
require the chain to pass through $(\pm 2,\cosh 2)$ and specify an arc
length of $e+e^{-1}$, giving $y=\cosh x$.

We are now in a position to assess the perturbation from the standard
catenary caused by small perturbations to the gravitational field
potential.  We will consider a gravitational potential of $y +
\epsilon\phi(x,y)$

\begin{eqnarray}\label{FandG}
F = \sqrt{1+y'^2}(y + \Lambda)\qquad G =  \sqrt{1+y'^2}(\phi + \lambda)
\end{eqnarray}
%
where $\phi=\phi(x,y)$ is a small perturbation.  Here 

\begin{eqnarray}
&{}& z''F_{y'y'}\nonumber\\
&+& z'(F_{xy'y'} + y'F_{yy'y'} + y''F_{y'y'y'})\nonumber\\
&+& z (F_{xyy'} + y'F_{yyy'} + y''F_{yy'}-F_{yy})\nonumber\\
&+& (G_{xy'} + y'G_{yy'} + y''G_{y'y'}- G_{y})\nonumber\\
= 0\\
&{}&  z''\left(\frac{y+\Lambda}{(1+y'^2)^{3/2}}\right)\nonumber\\
&+& z' \left(-\frac{y'}{(1+y'^2)^{3/2}} -\frac{3(y+\Lambda)y'y''}{(1+y'^2)^{5/2}}\right)\nonumber\\
&+& z  \left(\frac{y''}{(1+y'^2)^{3/2}}\right)\nonumber\\
&+& \frac{y'\phi_x-\phi_y}{\sqrt{1+y'^2}} + \frac{(\phi+\lambda)y''}{(1+y'^2)^{3/2}}=0
\end{eqnarray}
%
Now we may use the unperturbed solution of $y=\cosh x$, giving
$y=y''=\sqrt{1+y'^2}=\cosh x$ and $y'=\sinh x$.  After simplification:

\begin{equation}\label{pertcan}
  z'' - 4z'\tanh x - z =
  \phi + \lambda + \phi_x\sinh x\cosh x - \phi_y\cosh x
\end{equation}
%
Equation~\ref{pertcan} is readily solved numerically.  Three unknowns
are required: two constants of integration, as \ref{pertcan} is a
second order ODE; and the value of Lagrange's undetermined multiplier
$\lambda$.  In this case we have three three constraints corresponding
to the perturbation at the supports being zero, $z(\pm 2)=0$; and in
addition we know that the perturbed solution has the same arc length
as the unperturbed solution, for the chain is inextensible.

As an example we will consider a catenary that and troposkein.
Consider a rotating reference frame such as a rotating spaceship in
free fall.  Stationary objects in this frame behave as though they are
subject to a potential field of $m\omega\cdot\omega r_\perp^2$

\begin{equation}
  F = \sqrt{1+y'^2}(y+\Lambda)\qquad
  G = \sqrt{1+y'^2}y^2
\end{equation}

Equation \ref{pertcan} becomes

\begin{equation}
  z'' - 4z'\tanh x - z = \cosh^2 x(1+2\lambda)
\end{equation}

This equation is analytically intractable so we use numerical methods.
Here I find solutions for a standard $y=\cosh x$ catenary suspended at
endpoints $(\pm 2, \cosh 2)$.  To find meaningful solutions to this
equation, we specify that start point has zero perturbation,
$z(-2)=0$.  We then find values of $\lambda$ and initial slope
$(z'(-2)$ that jointly ensure $z(2)=0$ and that the chain has the same
length as the unperturbed solution.  It is straightforward to use
numerical techiques and we identify that $z'(0)\simeq 1.324$ and
$\lambda = -5.524$ satisfy the constraints.


\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{euler_lagrange_perturbed_files/figure-latex/showoptimspace-1.pdf}
\caption{Troposkein thing}\label{space}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{euler_lagrange_perturbed_files/figure-latex/showoptimspace-2.pdf}
\caption{Troposkein thing}\label{space2}
\end{figure}

Figures~\ref{space} and~\ref{space2} show a numerical simulation.  We
see that the catenary is distorted into a ``vee'' shape.


\subsection{Black holes}

In the theory of general relativity~\cite{misner}, the field equations
for a stationary, spherically symmetric point mass are solved by the
Schwarzschild metric that gives the squared interval $ds^2$ in terms
of spherical coordinates $(r,\theta,\phi)$:

\begin{eqnarray}\label{schwarzschild}
  ds^2=
  -dt^2(1-2M/r) + \frac{dr^2}{1-2M/r} + r^2d\theta^2 + r^2\sin\theta d\phi^2
  \end{eqnarray}

In equation~\ref{schwarzschild}, $M$ is the mass of the black hole
(using geometrized units so the mass has the dimensions of length).
Black holes are known to exhibit counterintuitive behaviour near the
event horizon~\cite{scientificamerican123} and one consequence of the
curvature of spacetime in the vicinity is that light inextensible
string under tension can adopt curved
configurations~\cite{hankin2022}.  Such taut inextensible strings
minimize their proper length, given by equation~\ref{proper}.

\begin{equation}\ref{proper}
  \int_{p_1}^{p_2}\sqrt{r^2 + \frac{r'^2}{1-2M/r}}\,d\phi
\end{equation}

To find the configuration $r=r(\phi)$ of a taut string we minimize
functional $F=\sqrt{r^2 + \frac{r'^2}{1-2M/r}}$.  The Euler-Lagrange
equations yield

\begin{equation}\label{eulerstring}
  r''(\phi) = (r-2M) + \frac{2r-3M)r'^2}{r(r-2M)}
\end{equation}


Below, following Einstein~\cite{einstein_mercury},
equation~\ref{schwarzschild} as a slight perturbation of classical
Newtonian physics.  First, we observe that in the limit
$M\longrightarrow 0$ we recover $r'' = r + 2r'/r$, having solution
$r=r_0\sec(\phi-\phi_0)$, a familiar straight line but expressed in
polar coordinates.

in which we can use polar coordinates $(r,\phi)$
and consider a taut string joining point $p_1=(r_1,\phi_1)$ to point
$p_2=(r_2,\phi_2)$.  The string will minimize its length thus we have
functional

\begin{equation}
  F=\sqrt{r^2 + r'^2}
\end{equation}

How might this solution be perturbed if we consider it to be a small
perturbation of from Newtonian to relativistic physics?  The first
thing to change would be that the string minimizes its {\em proper}
length:

The appropriate EL equation would be


which would have solution $r=r_0\sec(\phi-\phi_0)$.  How might this
solution be perturbed if we perturbed the system from Newtonian to
relativistic physics?  The first thing to change would be that the
string minimizes its {\em proper} length:

\begin{equation}
  \int_{p_1}^{p_2}\sqrt{r^2 + \frac{r'^2}{1-2M/r}}\,d\phi
\end{equation}

To fix ideas we consider the Earth's orbit around the sun, taking it
to be a nominal circle of radius $r_0=1.5\times 10^{11}\,\mathrm{m}$,
and use this as the unit of length.  If we take the Schwarzschild
radius $M$ of the Sun to be $3\times 10^3\,\mathrm{m}$, we find that
$M\simeq 2\times 10^{-8}$, and the linear approximation is reasonable;
to first order we have

\begin{equation}
\sqrt{r^2 + \frac{r'^2}{1-2M/r}}=\sqrt{r+r'^2} + M\frac{r'^2}{r\sqrt{r^2 + r'^2}}
\end{equation}
  
so $F=\sqrt{r^2+r'^2}$ and $G=M\frac{r'^2}{r\sqrt{r^2+r'^2}}$.  Then

\begin{eqnarray}
\frac{d}{dx}\left(\di{F}{r'}\right) -\di{F}{r} &=& 
\frac{r^2r''- 2rr'^2 -r^3}{(r^2 +r'^2)^{3/2}}.
\end{eqnarray}

This gives $r'' = r + 2r'^2/r$ in the unperturbed case, recovering the
familiar Euclidean straight-line solution from Newtonian physics:
$r=r_0\sec(\theta-\theta_0)$.  The left hand side of
equation~\ref{factorized_eqn} is then

\begin{eqnarray}
&{}& \left(z\di{}{r} + z'\di{}{r'} + z''\di{}{r''}\right)
\left(\frac{d}{dx}\di{F}{r'}
-\di{F}{r}\right)\nonumber\\
&=&  \left(z\di{}{r} + z'\di{}{r'} + z''\di{}{r''}\right)
\left(\frac{r^2r''- 2rr'^2 -r^3}{(r^2 +r'^2)^{3/2}}\right)\nonumber\\
&=& 
 z  \left(\frac{(r^2 - 2r'^2)(rr''-r'^2)}{(r^2 + r'^2)^{5/2}}\right)\nonumber\\
 &{}& + z' \left(\frac{rr'(r^2 - 2r'^2 + 3rr'')}{(r^2 + r'^2)^{5/2}}\right)
      + z''\left(\frac{r^2    (r^2+r'^2)       }{(r^2 + r'^2)^{5/2}}\right)
\end{eqnarray}

And now the non-homogeneous term:

\begin{eqnarray}
\frac{d}{dx}\left(\di{G}{r'}\right) -\di{G}{r} &=& 
\frac{d}{dx}\left(\frac{\partial}{\partial r'}\left(\frac{r'^2}{r\sqrt{r^2+r'^2}}\right)\right)
- \frac{\partial}{\partial
  r}\left(\frac{r'^2}{r\sqrt{r^2+r'^2}}\right)\nonumber\\
&=& \frac{(2r^2-r'^2)(rr''-r'^2)}{(r^2+r'^2)^{5/2}}
\end{eqnarray}

Combining and simplifying we have

\begin{eqnarray}
 &{}&z  \left((r^2 - 2r'^2)(rr''-r'^2)\right)\nonumber\\
+&{}&z'  \left(rr'(r^2 - 2r'^2 + 3rr'')\right)\nonumber\\
+&{}&z''  \left(r^2    (r^2+r'^2)       \right)\\
&{}&\qquad =\qquad -(2r^2-r'^2)(rr''-r'^2)
\end{eqnarray}

Now we are free to substitute.  We have $r=r_0\sec(\theta-\theta_0)$
but are given $r_0=1$ and will take $\theta_0=0$ for simplicity.  Thus
$r'= r_0\sec\theta\tan\theta$ and $r''=\sec\theta +
\sec\theta\tan^2\theta$.  Substituting and simplifying gives:

\begin{equation}\label{string_ODE}
z'' - 4z'\tan \theta + z(1-2\tan^2\theta) = \tan^2\theta - 2
\end{equation}


This does not appear to possess a simple analytical solution but
numerical methods may be used.  We have two degrees of freedom that
correspond to the specified radius at $p_1$ and $p_2$.  Taking
$p_1=(1,-\pi/4)$, $p_2=(1,\pi/4)$




\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl

\end{document}
